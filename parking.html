<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Parking</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family:Arial, sans-serif;
  background:#f4f6f9;
  margin:0;
  padding:15px;
  text-align:center;
}

h1{
  margin-bottom:5px;
}

.fecha{
  font-size:13px;
  color:#777;
  margin-bottom:15px;
}

.card{
  background:white;
  padding:15px;
  border-radius:14px;
  margin-bottom:15px;
  box-shadow:0 4px 12px rgba(0,0,0,0.05);
}

button{
  width:100%;
  padding:10px;
  margin:6px 0;
  border:none;
  border-radius:10px;
  background:#004481;
  color:white;
  font-weight:bold;
  font-size:14px;
}

button:hover{
  opacity:0.9;
}

.info{
  margin-top:10px;
  font-size:14px;
  color:#444;
  word-break:break-word;
}

.muted{
  color:#888;
  font-size:13px;
}
</style>
</head>
<body>

<h1>Parking</h1>
<div class="fecha" id="fechaHoy"></div>

<div class="card">

<button onclick="guardarUbicacion()">Guardar ubicaci贸n</button>

<button onclick="verUbicacion()">Ver ubicaci贸n</button>

<button onclick="irAndando()">Ir andando al coche</button>

<button onclick="borrarUbicacion()">Borrar ubicaci贸n</button>

<div class="info" id="infoUbicacion"></div>

</div>

<script>

/* ===== Fecha ===== */
const hoy = new Date();
document.getElementById("fechaHoy").textContent =
hoy.toLocaleDateString("es-ES");

/* ===== Estado ===== */
let ubicacionGuardada = JSON.parse(localStorage.getItem("parking_ubicacion")) || null;
mostrarInfo();

/* ===== Guardar ubicaci贸n ===== */
function guardarUbicacion(){

  if(!navigator.geolocation){
    alert("Geolocalizaci贸n no soportada.");
    return;
  }

  navigator.geolocation.getCurrentPosition(function(position){

    ubicacionGuardada = {
      lat: position.coords.latitude,
      lng: position.coords.longitude,
      fecha: new Date().toLocaleString("es-ES")
    };

    localStorage.setItem("parking_ubicacion", JSON.stringify(ubicacionGuardada));

    mostrarInfo();
    alert("Ubicaci贸n guardada correctamente");

  }, function(){
    alert("No se pudo obtener la ubicaci贸n. Aseg煤rate de dar permiso.");
  });

}

/* ===== Ver ubicaci贸n ===== */
function verUbicacion(){

  if(!ubicacionGuardada){
    alert("No hay ubicaci贸n guardada.");
    return;
  }

  const lat = ubicacionGuardada.lat;
  const lng = ubicacionGuardada.lng;

  alert(`Tu coche est谩 en:\n${lat}, ${lng}`);

  const url = `https://www.google.com/maps?q=${lat},${lng}`;
  window.open(url, "_blank");
}

/* ===== Ir andando ===== */
function irAndando(){

  if(!ubicacionGuardada){
    alert("No hay ubicaci贸n guardada.");
    return;
  }

  const lat = ubicacionGuardada.lat;
  const lng = ubicacionGuardada.lng;

  const url = `https://www.google.com/maps/dir/?api=1&destination=${lat},${lng}&travelmode=walking`;
  window.open(url, "_blank");
}

/* ===== Borrar ubicaci贸n ===== */
function borrarUbicacion(){

  if(!ubicacionGuardada){
    alert("No hay ubicaci贸n guardada.");
    return;
  }

  if(confirm("驴Seguro que quieres borrar la ubicaci贸n?")){
    ubicacionGuardada = null;
    localStorage.removeItem("parking_ubicacion");
    mostrarInfo();
    alert("Ubicaci贸n borrada.");
  }
}

/* ===== Mostrar info ===== */
function mostrarInfo(){

  const info = document.getElementById("infoUbicacion");

  if(!ubicacionGuardada){
    info.innerHTML = "<span class='muted'>No hay ubicaci贸n guardada.</span>";
    return;
  }

  info.innerHTML = `
     Lat: ${ubicacionGuardada.lat.toFixed(6)}<br>
     Lng: ${ubicacionGuardada.lng.toFixed(6)}<br>
     Guardado: ${ubicacionGuardada.fecha}
  `;
}

</script>

</body>
</html>
